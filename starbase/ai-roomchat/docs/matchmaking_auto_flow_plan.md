# 매칭 자동 진행 구현 플랜

## 단계 1. 진입 경로 및 상태 파악
- 로비 → 메인룸 → 모드 선택 모달 → `/rank/[id]/(solo|duo|casual)` 자동 매칭 페이지 흐름을 점검한다.
- 각 페이지에서 사용하는 클라이언트(`AutoMatchProgress`, `useMatchQueue`, `StartClient`)가 어떤 스토리지 키와 세션 값을 참조하는지 기록한다.
- 목표: 자동 참가가 막히는 지점을 특정할 수 있는 체킹 포인트 목록 확보.

## 단계 2. 자동 참가 가드 레일 추가
- `AutoMatchProgress`에서 뷰어 ID, 선택된 캐릭터, 선호 역할 준비 여부를 검사하고 대기 사유를 UI/콘솔에 노출한다.
- 자동 참가를 시도할 때마다 상태를 기록해 동일 조건에서 재시도할 수 있도록 한다.
- 목표: 페이지에 진입했음에도 수동 버튼이 노출되는 원인을 즉시 파악.

## 단계 3. 자동 참가 재시도 및 복구 루프
- 필요한 정보가 늦게 도착할 경우를 대비해, 조건 충족 시 자동으로 대기열 합류를 재시도한다.
- 대기열 진입 실패 시 수집한 메시지를 기반으로 사용자에게 안내한다.
- 목표: 캐릭터/역할이 뒤늦게 로드돼도 별도 조작 없이 매칭 대기열 합류.

## 단계 4. 듀오 전용 흐름 정비
- `DuoMatchClient`에서 파티 키 처리, 방 코드 입력 등 특수 변수를 점검한다.
- 자동 참가 로직이 듀오의 방 만들기/검색 분기와 충돌하지 않도록 필요한 훅을 정리한다.
- 목표: 듀오 전용 화면에서도 동일한 자동 진행 보장.

## 단계 5. 메인 게임 진입 검증
- `StartClient`에서 매칭 결과를 수신했을 때 API 키, 프롬프트, 오디오 프리셋이 정상적으로 연결되는지 확인한다.
- 실패 시 재시작 경로 혹은 히스토리 동기화 방법을 정의한다.
- 목표: 매칭 → 배틀 화면 전환까지 무인(auto) 상태로 이어지는지 최종 점검.

## 진행 상황 브리핑 템플릿
- 각 단계를 시작/완료할 때 요약 메모를 남겨 전체 흐름을 추적한다.
- 자동 참가가 막힌 조건, 복구 결과를 재현 절차와 함께 기록해 두 차례 이상 같은 문제가 반복되지 않도록 한다.


# 매칭 QA 체크리스트 (2025-11-18 갱신)

## 공통 준비
- [ ] Supabase 프로젝트에 `rank_match_queue`, `rank_participants`, `rank_rooms`, `rank_room_slots` 최신 스키마와 신규 인덱스가 적용되었는지 확인합니다.
- [ ] 테스트 계정 4개 이상을 준비하고, 각 계정에 기본 영웅과 역할 선호도가 저장돼 있는지 확인합니다.
- [ ] 관리자 모드에서 매칭 게임의 실시간 옵션/난입 옵션/점수 윈도우 설정 값을 사전에 기록합니다.

## 1. 실시간 + 난입 매칭
- [ ] 실시간·난입 옵션이 모두 켜진 상태에서 두 명 이상이 동일 역할로 대기열에 있을 때, 진행 중인 방의 빈 슬롯으로 자동 진입되는지 확인합니다.
- [ ] 난입 성공 시 `MatchQueueClient`에 룸 코드, 역할, 점수 차이가 요약되어 안내되는지 확인합니다.
- [ ] 난입 성공 후 5초 카운트다운이 노출되고, 안내 문구와 함께 메인 룸으로 자동 이동하는지 확인합니다.
- [ ] 난입 실패 시 재시도 버튼이 "즉시 다시 확인"으로 표시되고, 4초 폴링 외에도 즉시 요청이 가능한지 확인합니다.

## 2. 실시간 (난입 비활성)
- [ ] 실시간 옵션만 켠 상태에서 큐가 정상적으로 동일 점수대끼리 매칭되는지 확인합니다.
- [ ] 표본 축소가 적용되어 참가자 풀에서 보강되지 않는지 콘솔 메타 로그(`샘플 메타`)로 확인합니다.

## 3. 비실시간 매칭 (큐 보강)
- [ ] 실시간 옵션을 끄고 솔로/듀오/캐주얼 각각에서 매칭을 시도해, `매칭 상황` 카드가 대기열 요약과 경고를 표출하는지 확인합니다.
- [ ] 점수 윈도우 밖 참가자가 있을 때 "점수 차이" 경고가 노출되는지 확인합니다.
- [ ] 보강 후보가 없을 때 "조건을 충족하는 후보" 경고가 노출되는지 확인합니다.
- [ ] 역할별 최대 보강 수/총 보강 수가 제한에 도달했을 때 경고가 노출되는지 확인합니다.

## 4. 오류 및 재시도 UX
- [ ] `slot_missing_hero` 오류가 재현될 경우, 안내 문구가 캐릭터 선택 문제를 지적하는지 확인합니다.
- [ ] 매칭이 실패한 직후 "즉시 다시 확인" 버튼을 눌렀을 때 폴링 대기 없이 API가 호출되고, 버튼 상태가 재확인 중으로 바뀌는지 확인합니다.
- [ ] (표준/브롤) 매칭 성공 후에는 재확인 버튼이 비활성화되고, 자동으로 카운트다운과 턴 제한 투표 단계로 넘어가는지 확인합니다.

## 5. 로그 & 모니터링
- [ ] 브라우저 콘솔에 노출되는 `샘플 메타` 로그가 점수 윈도우/보강 수/필터 수를 담고 있는지 확인합니다.
- [ ] 실패 케이스에서 Supabase `rank_match_queue` 상태와 `rank_participants`의 `status` 업데이트가 일관되는지 확인합니다.
- [ ] 매칭 시도/성공/대기 이벤트가 `rank_matchmaking_logs` 테이블에 단계, 상태, 사유, 점수 윈도우와 함께 기록되는지 확인합니다.
- [ ] 관리자 포털의 "매칭 로그 요약" 카드가 전체 누적/최근 24시간 카운트와 최근 이벤트를 정상적으로 갱신하는지 확인합니다.

## 완료 조건
- [ ] 위 시나리오에서 발견된 문제점이 이슈로 등록되었거나 수정되었습니다.
- [ ] 매칭 청사진의 진행률이 갱신되었으며, 남은 작업 항목이 다음 액션에 반영되었습니다.


# Agent Playbook — starbase

이 문서는 이 저장소에서 "에이전트(자동화된 작업자)"가 따를 규칙과 작업 흐름을 정리합니다. 사용자는 에이전트에게 전권을 위임했으며, 에이전트는 아래 규칙을 기준으로 작업을 수행합니다.

목표
- 단위 테스트와 기본 CI를 안정화하고, 개발자 작업 부담을 줄이며, PR 생성·보고를 자동화합니다.

주요 역할
- 주기적으로(또는 이벤트 발생 시) 유닛 테스트 실행 및 실패 원인 분석
- 소규모, 안전한 코드수정(호환성, 테스트 내성, 로그 억제 등)을 적용
- 변경사항을 별도 브랜치에 커밋 및 PR 생성(또는 기존 PR 업데이트)
- PR에 테스트 결과 및 요약 문서(예: `PR_SUMMARY_*.md`)를 추가

운영 규칙
- 사람 허가 없이 위험한 변경(데이터 마이그레이션, 대규모 리팩토링, 자동 병합)은 수행하지 않습니다.
- 테스트/논리 변경이 아닌 경우 로그 억제, 테스트 셋업, 폴리필 같은 비파괴적 변경만 허용합니다.
- 모든 변경은 브랜치명 규칙 `copilot/<task>`를 사용하고, PR 제목에는 `[WIP]` 또는 목적을 명시합니다.
- 테스트 아티팩트(예: junit.xml)는 아티팩트 저장소에 업로드합니다.

PR 코멘트 가이드
- PR마다 다음 정보를 포함한 코멘트를 남깁니다:
  - 변경 요약 (한 문단)
  - 로컬/CI 테스트 요약 (스위트/테스트 통과 비율)
  - 다음 권장 작업(예: E2E, 린트, 사람이 볼 리뷰 포인트)

CI/워크플로우
- 간단한 GitHub Actions 워크플로우(이미 추가됨)로 push/PR 시 ai-roomchat 패키지의 Jest를 실행합니다.
- 실패 시 에이전트는 PR에 실패 요약을 남기고, 심각한 실패인 경우 수동 개입을 요청합니다.

세부 구현 노트
- 테스트 환경에서의 전역 변경(global.window, navigator)은 테스트용 복제본을 사용하거나, 코드 내 환경 감지 로직을 안전하게 작성해야 합니다.
- 디버그 로그 억제는 환경변수(`DEBUG_TOOL_VERBOSE`)로 재활성화할 수 있어야 합니다.

보안 및 비밀
- 에이전트는 저장소의 시크릿을 노출하거나 외부에 전송하지 않습니다. CI 토큰(예: GITHUB_TOKEN)은 PR 코멘트/워크플로우 실행에만 사용합니다.

변경 기록
- 2025-10-23: 에이전트 초기 플레이북 작성 및 `ci-jest.yml` 추가, PR 요약 파일 추가.
